(this["webpackJsonplittle-messenger"]=this["webpackJsonplittle-messenger"]||[]).push([[0],{100:function(e,t,n){e.exports=n(166)},166:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(18),o=n.n(c),u=n(36),i=n(3),l=n(4),s=n(12),f=n.n(s),p=n(10),m=n(25),d=n(48),g=n.n(d);n(106),n(107);try{g.a.initializeApp({apiKey:"AIzaSyDNke9iMr3CT9fPZtT3CialnX97P5VbPvs",authDomain:"little-messanger.firebaseapp.com",databaseURL:"https://little-messanger.firebaseio.com",projectId:"little-messanger",storageBucket:"little-messanger.appspot.com",messagingSenderId:"536362779937",appId:"1:536362779937:web:f717d221b46459e317ea60"})}catch(Ye){console.log(Ye)}var b=new g.a.auth.GithubAuthProvider,v=g.a,h=function(e){var t=(e||null).user;return{name:t.email.split("@")[0],email:t.email,uid:t.uid}},x=function(e){localStorage.setItem("little-messenger-user",e)},E=n(19),O=n.n(E),j="https://little-messanger.firebaseio.com",y=n(167),S=function(e){return{type:"USER/SET_USER",payload:e}},w=n(20),k=n(168);function _(){var e=Object(i.a)(["\n    text-align: center;    \n"]);return _=function(){return e},e}function P(){var e=Object(i.a)(["\n    display: flex;\n    justify-content: space-between;\n    margin-top: 5px;\n"]);return P=function(){return e},e}function C(){var e=Object(i.a)(["\n    margin-bottom: 5px;\n"]);return C=function(){return e},e}function T(){var e=Object(i.a)(["\n    padding: 10px;\n    display: flex;\n    flex-direction: column;\n    max-width: 250px;\n    margin: 0 auto;\n        margin-top: 100px;\n    border: 1px solid black;\n    box-shadow: 0 0 10px rgba(0,0,0,0.5);\n"]);return T=function(){return e},e}var A=l.a.div(T()),R=l.a.input(C()),U=l.a.div(P()),I=l.a.h4(_()),N={authWithEmail:function(e,t){return function(){var n=Object(m.a)(f.a.mark((function n(r){var a,c,o,u;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.auth().signInWithEmailAndPassword(e,t);case 3:return a=n.sent,c=h(a),n.next=7,O.a.get("".concat(j,"/users/.json"));case 7:return o=n.sent,u=Object.keys(o.data).filter((function(t){return t!==e.split("@")[0]})),x(c.name),r(S(Object(p.a)(Object(p.a)({},c),{},{contacts:u}))),n.abrupt("return",!0);case 14:n.prev=14,n.t0=n.catch(0),y.b.error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"),console.log("Error",n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e){return n.apply(this,arguments)}}()},registration:function(e,t){return function(){var n=Object(m.a)(f.a.mark((function n(r){var a,c,o,u;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,v.auth().createUserWithEmailAndPassword(e,t);case 3:return a=n.sent,c=h(a),n.next=7,O.a.put("".concat(j,"/users/").concat(c.name,".json"),Object(p.a)({},c));case 7:return n.next=9,O.a.get("".concat(j,"/users/.json"));case 9:return o=n.sent,u=Object.keys(o.data).filter((function(e){return e!==c.email.split("@")[0]})),x(c.name),r(S(Object(p.a)(Object(p.a)({},c),{},{contacts:u}))),n.abrupt("return",!0);case 16:n.prev=16,n.t0=n.catch(0),console.log("Error",n.t0);case 19:case"end":return n.stop()}}),n,null,[[0,16]])})));return function(e){return n.apply(this,arguments)}}()},authGithub:function(){return function(){var e=Object(m.a)(f.a.mark((function e(t){var n,r,a,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.auth().signInWithPopup(b);case 3:return n=e.sent,r=h(n),e.next=7,O.a.get("".concat(j,"/users/.json"));case 7:return a=e.sent,c=Object.keys(a.data).filter((function(e){return e!==r.email.split("@")[0]})),x(r.name),t(S(Object(p.a)(Object(p.a)({},r),{},{contacts:c}))),e.abrupt("return",!0);case 14:e.prev=14,e.t0=e.catch(0),console.log("Error",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t){return e.apply(this,arguments)}}()}},D=Object(w.b)((function(e){return{authStore:e.authStore}}),N)((function(e){var t=Object(r.useState)("v@gmail.com"),n=Object(u.a)(t,2),c=n[0],o=n[1],i=Object(r.useState)("123456"),l=Object(u.a)(i,2),s=l[0],f=l[1],p=e.authWithEmail,m=e.registration,d=e.authGithub,g=function(t){t(c,s).then((function(t){t?(y.b.success("\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0440\u043e\u0432\u0430\u043d"),setTimeout((function(){e.history.push("/messenger")}),1e3)):y.b.error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430 c \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0435\u0439")}))};return a.a.createElement(A,null,a.a.createElement(I,null,"Little messenger"),a.a.createElement(R,{value:c,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",onChange:function(e){return function(e){return o(e.target.value)}(e)}}),a.a.createElement(R,{value:s,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c",onChange:function(e){return function(e){return f(e.target.value)}(e)}}),a.a.createElement(k.a,{variant:"outline-success",onClick:function(){return g(p)}},"\u0412\u043e\u0439\u0442\u0438"),a.a.createElement(U,null,a.a.createElement(k.a,{variant:"outline-primary",size:"sm",onClick:function(){return g(d)}},"\u0413\u0438\u0442\u0445\u0430\u0431"),a.a.createElement(k.a,{variant:"outline-info",size:"sm",onClick:function(){return g(m)}},"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f")))}));function M(){var e=Object(i.a)(["\n\tdisplay: flex;\n\tjustify-content: center;\n\tmargin-left: 16px;\n\tcolor: white;\n"]);return M=function(){return e},e}function L(){var e=Object(i.a)(["\n\tdisplay: flex;\n\tjustify-content: flex-end;\n\tmargin-right: 10px;\n\tcolor: white;\n\t&:hover {\n\tcolor: aliceblue } \n"]);return L=function(){return e},e}function z(){var e=Object(i.a)(["\n    display: flex;\n    background-color: #314154;\n    text-align: center;\n    padding: 2px;\n    justify-content: space-between;\n"]);return z=function(){return e},e}var X=l.a.header(z()),G=l.a.div(L()),V=l.a.div(M()),W=function(e){var t=e.onSignOut,n=e.currentUser;return a.a.createElement(X,null,a.a.createElement(V,null,n?"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: ".concat(n):"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c: \u043d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d"),a.a.createElement(G,null,a.a.createElement(k.a,{style:{backgroundColor:"#2b5279"},variant:"secondary",size:"sm",onClick:t},"\u0412\u044b\u0445\u043e\u0434")))};function J(){var e=Object(i.a)(["\n\tcolor: #3d5169;\n\tmargin: 2px;\n\tmargin-left: 16px;\n\tfont-size: small;\n"]);return J=function(){return e},e}function F(){var e=Object(i.a)(["\n\tcolor: white;\n\tmargin: 2px;\n\tmargin-left: 16px;\n"]);return F=function(){return e},e}function B(){var e=Object(i.a)(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tmargin: 0 auto;\n\tbackground-color: #233343;\n"]);return B=function(){return e},e}var H=l.a.div(B()),K=l.a.p(F()),Z=l.a.p(J()),q=function(e){var t=e.recipient,n=e.messages,r=null;return n&&(r=n[n.length-1].date,console.log(r)),a.a.createElement(H,null,t?a.a.createElement(K,null,"\u041a\u043e\u043c\u0443: ",t):a.a.createElement(K,null,"\u041a\u043e\u043c\u0443: \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e"),n?a.a.createElement(Z,null,r):"")};function Q(){var e=Object(i.a)(["\n\tbackground-color: #142233;\n\tmin-height: 30px;\n\tborder: none;\n\tcolor: white;\n\toutline: none;\n\twidth: 100%;\n\tpadding: 15px;\n\tbox-sizing: border-box;\n"]);return Q=function(){return e},e}function Y(){var e=Object(i.a)([""]);return Y=function(){return e},e}var $=l.a.div(Y()),ee=l.a.input(Q()),te=function(e){var t=e.onSendMessage,n=e.currentUser,c=e.recipient,o=Object(r.useState)(""),i=Object(u.a)(o,2),l=i[0],s=i[1],f=Object(r.useRef)(null);return Object(r.useEffect)((function(){f.current.focus()})),a.a.createElement($,null,a.a.createElement("form",{onSubmit:function(e){return function(e){e.preventDefault(),t(l),s("")}(e)}},a.a.createElement(ee,{ref:f,placeholder:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435",disabled:!n||!c,value:l,onChange:function(e){return function(e){return s(e.target.value)}(e)}})))},ne=n(96),re=function(e){return{type:"APP/ADD_MESSAGE",payload:e}},ae=function(e){return{type:"APP/SET_CONTACT",payload:e}},ce=n(92),oe=n.n(ce);function ue(){var e=Object(i.a)(["\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\tcolor: white;\n\twidth: 55px;\n\theight: 55px;\n\tcursor: pointer;\n    border-radius: 100px;\n    background-color: ",";\n"]);return ue=function(){return e},e}function ie(){var e=Object(i.a)(["\n\tlist-style: none;\n    padding: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    height: 65px;\n    width: 100%;\n    background-color: ",";\n"]);return ie=function(){return e},e}var le=l.a.li(ie(),(function(e){return e.isSelected?"#142233":""})),se=l.a.div(ue(),(function(e){return e.color?e.color:"palevioletred"})),fe=function(e){var t=e.onSelect,n=e.contact,r=e.color,c=e.userName,o=e.isSelected;return a.a.createElement(le,{onClick:function(){return t(n,c)},isSelected:o},a.a.createElement(se,{color:r},n&&n.slice(0,3)))};function pe(){var e=Object(i.a)(["\n\twidth: 100%;\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n"]);return pe=function(){return e},e}function me(){var e=Object(i.a)(["\n\tbackground-color: #233343;\n\twidth: 15%;\n\tborder-top: 1px solid #15171980;\n\tborder-bottom: 1px solid #15171980;\n\toverflow-y: auto;\n    height: 364px;\n    display: flex;\n    justify-content: center;\n}\n"]);return me=function(){return e},e}var de=l.a.aside(me()),ge=l.a.ul(pe()),be=["#980303","#28a745","#ffc107","#20c997"],ve={selectRecipient:function(e,t){return function(){var n=Object(m.a)(f.a.mark((function n(r){var a,c;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,O.a.get("".concat(j,"/users/").concat(t,"/messagesList/.json"));case 2:(a=n.sent).data?(c=a.data[e],r(ae({recipient:e,messages:c}))):r(ae({recipient:e}));case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}},he=Object(w.b)((function(e){return{currentChatId:e.appStore.recipient}}),ve)((function(e){var t=e.contacts,n=e.selectRecipient,r=e.userName,c=e.currentChatId;return a.a.createElement(de,null,a.a.createElement(ge,null,t&&t.map((function(e,t){var o=be[t];return a.a.createElement(fe,{key:e+t,color:o,contact:e,onSelect:n,isSelected:c===e,userName:r})}))))}));function xe(){var e=Object(i.a)(["\n    display: flex;\n    color: white;\n    border: 1px solid #eee;\n    padding: 15px;\n    position: relative;\n    left: -40%;\n    top: 35%;\n"]);return xe=function(){return e},e}function Ee(){var e=Object(i.a)(["\n    margin: 0;\n    font-size: small;\n    color: #233343;\n    position: absolute;\n    left: 15px;\n    top: 10px;\n"]);return Ee=function(){return e},e}function Oe(){var e=Object(i.a)(["\n    color: red;\n\tposition: relative;\n    left: -40%;\n    top: 40%;\n"]);return Oe=function(){return e},e}function je(){var e=Object(i.a)(["\n   margin: 0\n"]);return je=function(){return e},e}function ye(){var e=Object(i.a)(["\n    display: flex;\n    max-width: 225px;\n    position: relative;\n    padding: 5px;\n    background-color: #2b5279;\n    color: white;\n    margin: 5px 10px;\n    padding: 10px;\n    padding-right: 25px;\n    border-radius: 5px;\n"]);return ye=function(){return e},e}var Se=l.a.div(ye()),we=l.a.p(je()),ke=l.a.p(Oe()),_e=(l.a.p(Ee()),l.a.p(xe())),Pe=function(e){var t=e.text,n=e.recipient,r={};return n===e.author&&(r={backgroundColor:"#009688"}),"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043d\u0435\u0442"===t&&n?a.a.createElement(_e,null,t):a.a.createElement(a.a.Fragment,null,n?a.a.createElement(Se,{style:r},a.a.createElement(we,null,t)):a.a.createElement(ke,null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0438\u0430\u043b\u043e\u0433"))};function Ce(){var e=Object(i.a)(["\n\tcolor: red;\n\tposition: relative;\n    left: -40%;\n    top: 40%;\n"]);return Ce=function(){return e},e}function Te(){var e=Object(i.a)(["\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground-color: #142233;\n\twidth: 100%;\n\talign-items: flex-end;\n\tborder: 1px solid black;\n\toverflow-y: auto;\n    height: 364px;\n"]);return Te=function(){return e},e}var Ae=l.a.section(Te()),Re=l.a.p(Ce()),Ue=function(e){var t=e.messages,n=e.userName,c=e.recipient,o=Object(r.useRef)(null);return Object(r.useEffect)((function(){o.current.scrollTop=o.current.scrollHeight})),a.a.createElement(Ae,{ref:o},n?t?t.map((function(e,t){return a.a.createElement(Pe,{text:e.text,author:e.author,key:e.text+t,recipient:c})})):a.a.createElement(Pe,{text:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439 \u043d\u0435\u0442",recipient:c}):a.a.createElement(Re,null,"\u041f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u0430 \u0441\u0442\u0430\u0434\u0438\u044f \u043b\u043e\u0433\u0438\u043d\u0430"))};function Ie(){var e=Object(i.a)(["\n\tdisplay: flex;\n\tmin-height: 320px;\n"]);return Ie=function(){return e},e}function Ne(){var e=Object(i.a)(["\n\tmargin: 0 auto;\n\tmax-width: 720px;\n"]);return Ne=function(){return e},e}var De,Me=l.a.div(Ne()),Le=l.a.div(Ie()),ze={signOut:function(){return v.auth().signOut().then((function(){console.log("Logout successful")})).catch((function(e){console.log(e)})),{type:"USER/REMOVE_USER"}},sendTyRecipientMessage:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0;return function(){var a=Object(m.a)(f.a.mark((function a(c){var o;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return o=[].concat(Object(ne.a)(n),[{author:e,text:r,date:+new Date}]),a.next=3,O.a.put("".concat(j,"/users/").concat(e,"/messagesList/").concat(t,".json"),o);case 3:return a.next=5,O.a.put("".concat(j,"/users/").concat(t,"/messagesList/").concat(e,".json"),o);case 5:c(re(o));case 6:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},signOutApp:function(){return{type:"APP/EXIT"}},addMessage:re},Xe=Object(w.b)((function(e){return{authStore:e.authStore,appStore:e.appStore}}),ze)((function(e){var t=e.signOut,n=e.authStore,r=e.appStore,c=e.sendTyRecipientMessage,o=e.signOutApp,u=e.addMessage,i=r.recipient,l=r.messages,s=n.email,f=n.contacts,p=e.authStore.name,m=r.messages?JSON.stringify(r.messages):null;return oe.a.database().ref("users/".concat(p,"/messagesList/").concat(i)).on("value",(function(e){(e.val()?JSON.stringify(e.val()):null)!==m&&u(e.val())})),a.a.createElement(a.a.Fragment,null,a.a.createElement(Me,null,a.a.createElement(W,{onSignOut:function(){localStorage.removeItem("little-messenger-user"),t(),o(),e.history.push("/"),y.b.info("\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d \u0432\u044b\u0445\u043e\u0434 \u0438\u0437 \u0443\u0447\u0435\u0442\u043d\u043e\u0439 \u0437\u0430\u043f\u0438\u0441\u0438")},currentUser:s}),a.a.createElement(q,{recipient:i,messages:l}),a.a.createElement(Le,null,a.a.createElement(he,{contacts:f,userName:p}),a.a.createElement(Ue,{userName:p,messages:l,recipient:i})),a.a.createElement(te,{onSendMessage:function(e){c(p,i,l,e)},currentUser:s,recipient:i})))})),Ge=n(93),Ve=n(5),We={loadUserData:function(e){return function(){var t=Object(m.a)(f.a.mark((function t(n){var r,a,c,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,O.a.get("".concat(j,"/users/").concat(e,"/.json"));case 3:return r=t.sent,a=Object(p.a)({},r.data),t.next=7,O.a.get("".concat(j,"/users/.json"));case 7:c=t.sent,o=Object.keys(c.data).filter((function(e){return e!==a.email.split("@")[0]})),x(a.name),n(S(Object(p.a)(Object(p.a)({},a),{},{contacts:o}))),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),y.b.error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"),console.log("Error",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}()}},Je=Object(w.b)((function(e){return{authStore:e.authStore}}),We)((function(e){var t=e.authStore.name;return Object(r.useEffect)((function(){t&&e.loadUserData(t)}),[]),a.a.createElement(a.a.Fragment,null,a.a.createElement(Ge.a,null,a.a.createElement(Ve.b,{exact:!0,path:"/",render:function(e){return t?a.a.createElement(Ve.a,{to:"/messenger"}):a.a.createElement(D,e)}}),a.a.createElement(Ve.b,{path:"/messenger",component:Xe})))})),Fe=n(24),Be=(De=localStorage["little-messenger-user"])?{name:De}:{};var He=Object(Fe.c)({authStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Be,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case"USER/SET_USER":return Object(p.a)({},r);case"USER/REMOVE_USER":return{};default:return e}},appStore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case"APP/SET_CONTACT":return Object(p.a)({},r);case"APP/ADD_MESSAGE":return Object(p.a)(Object(p.a)({},e),{},{messages:r});case"APP/EXIT":return{};default:return e}}}),Ke=n(94),Ze="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):Fe.d,qe=function(){return Object(Fe.e)(He,Ze(Object(Fe.a)(Ke.a)))},Qe=(n(164),n(165),qe());o.a.render(a.a.createElement(w.a,{store:Qe},a.a.createElement(Je,null)),document.getElementById("root"))}},[[100,1,2]]]);
//# sourceMappingURL=main.3d201045.chunk.js.map